-- BASE SCHEMA --
-- Enable Row Level Security
alter default privileges in schema public grant all on tables to postgres, anon, authenticated, service_role;

-- 1. Operations Summary (Replaces staticData)
create table if not exists operations_summary (
  id bigint generated by default as identity primary key,
  year integer not null,
  month integer, -- null for yearly totals
  category text not null, -- 'comercial', 'carga', 'general'
  metric text not null, -- 'operaciones', 'pasajeros', 'toneladas'
  value numeric not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. Medical Attentions (Replaces atenciones_medicas.json)
create table if not exists medical_attentions (
  id bigint generated by default as identity primary key,
  year integer not null,
  month text not null, -- 'ENERO', 'FEBRERO', etc.
  aifa_count integer default 0,
  other_company_count integer default 0,
  passenger_count integer default 0,
  visitor_count integer default 0,
  total integer generated always as (aifa_count + other_company_count + passenger_count + visitor_count) stored,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 3. Wildlife Incidents (Replaces fauna.json)
create table if not exists wildlife_incidents (
  id bigint generated by default as identity primary key,
  date date,
  time time,
  location text,
  impact_zone text,
  phase text,
  airline text,
  aircraft text,
  registration text,
  remains_location text,
  remains_amount text,
  size text,
  species text,
  common_name text,
  reporter text,
  proactive_measures text,
  weather_conditions text,
  results text,
  observations text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 4. Flight Itinerary (Replaces itinerario.json)
create table if not exists flight_itinerary (
  id bigint generated by default as identity primary key,
  category text, -- 'Pasajeros', 'Carga'
  airline text,
  aircraft text,
  arrival_flight text,
  arrival_date date,
  arrival_time time,
  origin text,
  claim_belt text,
  position text,
  departure_flight text,
  departure_date date,
  departure_time time,
  destination text,
  gate text,
  status text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 5. Delays (Replaces demoras.json)
create table if not exists delays (
  id bigint generated by default as identity primary key,
  year integer not null,
  month text not null,
  cause text not null, -- 'Repercusión', 'Compañía', etc.
  count integer default 0,
  description text,
  observations text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 6. Punctuality (Replaces puntualidad.json)
create table if not exists punctuality (
  id bigint generated by default as identity primary key,
  year integer not null,
  month text not null,
  category text,
  airline text,
  on_time integer default 0,
  delayed integer default 0,
  cancelled integer default 0,
  total integer generated always as (on_time + delayed + cancelled) stored,
  percentage numeric, -- Can be calculated, but storing for cache
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- RLS Policies (Example: Allow read to everyone, write to authenticated users with role)
-- For now, we'll allow public read and authenticated write.

alter table operations_summary enable row level security;
create policy "Public read access" on operations_summary for select using (true);
create policy "Authenticated update access" on operations_summary for all using (auth.role() = 'authenticated');

alter table medical_attentions enable row level security;
create policy "Public read access" on medical_attentions for select using (true);
create policy "Authenticated update access" on medical_attentions for all using (auth.role() = 'authenticated');

alter table wildlife_incidents enable row level security;
create policy "Public read access" on wildlife_incidents for select using (true);
create policy "Authenticated update access" on wildlife_incidents for all using (auth.role() = 'authenticated');

alter table flight_itinerary enable row level security;
create policy "Public read access" on flight_itinerary for select using (true);
create policy "Authenticated update access" on flight_itinerary for all using (auth.role() = 'authenticated');

alter table delays enable row level security;
create policy "Public read access" on delays for select using (true);
create policy "Authenticated update access" on delays for all using (auth.role() = 'authenticated');

alter table punctuality enable row level security;
create policy "Public read access" on punctuality for select using (true);
create policy "Authenticated update access" on punctuality for all using (auth.role() = 'authenticated');



-- DAILY OPERATIONS SCHEMA --

-- 1. Eliminar la tabla si existe (para empezar de cero)
DROP TABLE IF EXISTS daily_operations;

-- 2. Crear la tabla nuevamente con la estructura correcta
CREATE TABLE IF NOT EXISTS daily_operations (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    fecha DATE NOT NULL UNIQUE,
    comercial_llegada INTEGER DEFAULT 0,
    comercial_salida INTEGER DEFAULT 0,
    carga_llegada INTEGER DEFAULT 0,
    carga_salida INTEGER DEFAULT 0,
    general_llegada INTEGER DEFAULT 0,
    general_salida INTEGER DEFAULT 0,
    total_general INTEGER DEFAULT 0,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL
);

-- 3. Comentarios opcionales
COMMENT ON TABLE daily_operations IS 'Registro diario de operaciones aéreas (llegadas y salidas) por tipo de aviación';

-- 4. Habilitar acceso público (opcional, si tienes problemas de permisos)
ALTER TABLE daily_operations ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Permitir lectura publica" ON daily_operations
FOR SELECT USING (true);

CREATE POLICY "Permitir todo a autenticados" ON daily_operations
FOR ALL TO authenticated USING (true) WITH CHECK (true);

CREATE POLICY "Permitir todo a anonimos (si es necesario)" ON daily_operations
FOR ALL TO anon USING (true) WITH CHECK (true);



-- WEEKLY FREQUENCIES SCHEMA & DATA --

-- Create table for weekly frequencies
CREATE TABLE IF NOT EXISTS weekly_frequencies (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    week_label TEXT NOT NULL,
    valid_from DATE NOT NULL,
    valid_to DATE NOT NULL,
    route_id INTEGER,
    city TEXT,
    state TEXT,
    iata TEXT,
    airline TEXT,
    monday INTEGER DEFAULT 0,
    tuesday INTEGER DEFAULT 0,
    wednesday INTEGER DEFAULT 0,
    thursday INTEGER DEFAULT 0,
    friday INTEGER DEFAULT 0,
    saturday INTEGER DEFAULT 0,
    sunday INTEGER DEFAULT 0,
    weekly_total INTEGER DEFAULT 0,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Enable RLS
ALTER TABLE weekly_frequencies ENABLE ROW LEVEL SECURITY;

-- Create policy to allow read access to everyone
CREATE POLICY "Allow public read access" ON weekly_frequencies FOR SELECT USING (true);

-- Create policy to allow authenticated users to insert/update/delete
CREATE POLICY "Allow authenticated insert" ON weekly_frequencies FOR INSERT WITH CHECK (auth.role() = 'authenticated');
CREATE POLICY "Allow authenticated update" ON weekly_frequencies FOR UPDATE USING (auth.role() = 'authenticated');
CREATE POLICY "Allow authenticated delete" ON weekly_frequencies FOR DELETE USING (auth.role() = 'authenticated');

-- Insert data
INSERT INTO weekly_frequencies (week_label, valid_from, valid_to, route_id, city, state, iata, airline, monday, tuesday, wednesday, thursday, friday, saturday, sunday, weekly_total) VALUES
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 1, 'Tijuana', 'Baja California', 'TIJ', 'Viva Aerobus', 3, 0, 2, 3, 2, 0, 3, 19),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 1, 'Tijuana', 'Baja California', 'TIJ', 'Volaris', 1, 0, 0, 1, 0, 1, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 2, 'Hermosillo', 'Sonora', 'HMO', 'Mexicana', 1, 0, 1, 1, 1, 1, 1, 6),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 2, 'Hermosillo', 'Sonora', 'HMO', 'Viva Aerobus', 0, 0, 0, 1, 1, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 3, 'Ciudad Juárez', 'Chihuahua', 'CJS', 'Viva Aerobus', 0, 0, 0, 1, 0, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 4, 'Ciudad Obregón', 'Sonora', 'CEN', 'Viva Aerobus', 1, 0, 1, 0, 1, 1, 1, 4),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 4, 'Ciudad Obregón', 'Sonora', 'CEN', 'Viva Aerobus', 0, 0, 1, 0, 0, 0, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 5, 'Chihuahua', 'Chihuahua', 'CUU', 'Viva Aerobus', 2, 1, 1, 1, 2, 1, 1, 9),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 6, 'Nuevo Laredo', 'Tamaulipas', 'NLD', 'Viva Aerobus', 2, 1, 1, 1, 1, 0, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 7, 'Reynosa', 'Tamaulipas', 'REX', 'Viva Aerobus', 1, 0, 0, 0, 0, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 7, 'Reynosa', 'Tamaulipas', 'REX', 'Viva Aerobus', 0, 0, 0, 1, 1, 1, 0, 5),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 8, 'La Paz', 'Baja California Sur', 'LAP', 'Volaris', 0, 1, 0, 1, 0, 1, 0, 3),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 9, 'Culiacán', 'Sinaloa', 'CUL', 'Viva Aerobus', 1, 1, 1, 1, 0, 1, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 10, 'Durango', 'Durango', 'DGO', 'Aeroméxico', 1, 1, 1, 0, 1, 1, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 11, 'Monterrey', 'Nuevo León', 'MTY', 'Viva Aerobus', 6, 5, 5, 6, 5, 5, 6, 40),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 12, 'Ciudad Victoria', 'Tamaulipas', 'CVM', 'Aeroméxico', 1, 0, 1, 0, 1, 1, 1, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 13, 'Matamoros', 'Tamaulipas', 'MAM', 'Mexicana', 2, 0, 2, 0, 2, 2, 2, 2),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 13, 'Matamoros', 'Tamaulipas', 'MAM', 'Aerus', 1, 0, 1, 0, 0, 0, 1, 11),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 13, 'Matamoros', 'Tamaulipas', 'MAM', 'Viva Aerobus', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 13, 'Matamoros', 'Tamaulipas', 'MAM', 'Viva Aerobus', 1, 0, 0, 0, 0, 1, 0, 5),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 14, 'San José del Cabo', 'Baja California Sur', 'SJD', 'Volaris', 1, 0, 0, 0, 0, 1, 0, 4),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 15, 'Mazatlán', 'Sinaloa', 'MZT', 'Mexicana', 0, 0, 0, 0, 0, 0, 0, 2),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 15, 'Mazatlán', 'Sinaloa', 'MZT', 'Viva Aerobus', 0, 0, 0, 0, 0, 0, 0, 0),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 16, 'Tepic', 'Nayarit', 'TPQ', 'Viva Aerobus', 1, 0, 0, 0, 0, 0, 0, 6),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 17, 'San Luis Potosí', 'San Luis Potosí', 'SLP', 'Aerus', 0, 0, 0, 0, 0, 0, 0, 0),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 18, 'Tampico', 'Tamaulipas', 'TAM', 'Viva Aerobus', 0, 0, 0, 0, 0, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 18, 'Tampico', 'Tamaulipas', 'TAM', 'Desconocido', 0, 0, 0, 0, 0, 0, 0, 10),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 19, 'Puerto Vallarta', 'Jalisco', 'PVR', 'Mexicana', 1, 0, 0, 0, 0, 1, 0, 2),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 19, 'Puerto Vallarta', 'Jalisco', 'PVR', 'Aeroméxico', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 20, 'Guadalajara', 'Jalisco', 'GDL', 'Aeroméxico', 1, 2, 0, 0, 0, 4, 0, 29),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 20, 'Guadalajara', 'Jalisco', 'GDL', 'Volaris', 2, 0, 0, 0, 0, 3, 0, 21),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 23, 'Zihuatanejo', 'Guerrero', 'ZIH', 'Mexicana', 0, 0, 0, 0, 0, 0, 0, 2),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 23, 'Zihuatanejo', 'Guerrero', 'ZIH', 'Viva Aerobus', 0, 0, 0, 0, 0, 0, 0, 0),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 24, 'Acapulco', 'Guerrero', 'ACA', 'Viva Aerobus', 1, 0, 0, 0, 0, 0, 0, 14),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 25, 'Oaxaca', 'Oaxaca', 'OAX', 'Aeroméxico', 1, 0, 0, 0, 0, 0, 0, 6),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 26, 'Veracruz', 'Veracruz', 'VER', 'Aeroméxico', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 26, 'Veracruz', 'Veracruz', 'VER', 'Viva Aerobus', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 29, 'Mérida', 'Yucatán', 'MID', 'Mexicana', 2, 0, 0, 0, 0, 3, 0, 15),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 29, 'Mérida', 'Yucatán', 'MID', 'Mexicana', 0, 0, 0, 0, 0, 0, 0, 5),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 29, 'Mérida', 'Yucatán', 'MID', 'Aeroméxico', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 29, 'Mérida', 'Yucatán', 'MID', 'Volaris', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 29, 'Mérida', 'Yucatán', 'MID', 'Viva Aerobus', 2, 0, 0, 0, 0, 2, 0, 11),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 30, 'Tulum', 'Quintana Roo', 'TQO', 'Mexicana', 1, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 30, 'Tulum', 'Quintana Roo', 'TQO', 'Aeroméxico', 1, 0, 0, 1, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 30, 'Tulum', 'Quintana Roo', 'TQO', 'Viva Aerobus', 5, 0, 0, 0, 0, 5, 0, 33),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 31, 'Cancún', 'Quintana Roo', 'CUN', 'Aeroméxico', 0, 0, 0, 0, 0, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 32, 'Puerto Escondido', 'Oaxaca', 'PXM', 'Volaris', 0, 0, 0, 0, 0, 0, 0, 5),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 32, 'Puerto Escondido', 'Oaxaca', 'PXM', 'Viva Aerobus', 0, 0, 0, 0, 0, 0, 0, 5),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 33, 'Huatulco', 'Oaxaca', 'HUX', 'Viva Aerobus', 0, 0, 0, 0, 0, 1, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 34, 'Ixtepec', 'Oaxaca', 'IZT', 'Mexicana', 0, 0, 0, 0, 0, 0, 0, 3),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 35, 'Tuxtla Gutiérrez', 'Chiapas', 'TGZ', 'Viva Aerobus', 2, 0, 0, 0, 0, 0, 0, 9),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 36, 'Saltillo', 'Coahuila', 'SLW', 'Viva Aerobus', 1, 0, 0, 0, 0, 0, 0, 7),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 37, 'Palenque', 'Chiapas', 'PQM', 'Mexicana', 1, 0, 0, 0, 0, 0, 0, 2),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 38, 'Chetumal', 'Quintana Roo', 'CTM', 'Mexicana', 1, 0, 0, 0, 0, 0, 0, 3),
('08-14 Dic 2025', '2025-12-08', '2025-12-14', 38, 'Chetumal', 'Quintana Roo', 'CTM', 'Viva Aerobus', 0, 0, 0, 0, 0, 0, 0, 4);


-- MONTHLY OPERATIONS SCHEMA & DATA --
-- 001_monthly_operations_2025.sql
-- DDL y datos mensuales (2025) para la tabla monthly_operations
-- Ejecutar en Supabase -> Database -> SQL editor

CREATE TABLE IF NOT EXISTS monthly_operations (
  id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  year INTEGER NOT NULL,
  month SMALLINT NOT NULL CHECK (month BETWEEN 1 AND 12),
  comercial_ops INTEGER DEFAULT 0,
  comercial_pax BIGINT DEFAULT 0,
  general_ops INTEGER DEFAULT 0,
  general_pax BIGINT DEFAULT 0,
  carga_ops INTEGER DEFAULT 0,
  carga_tons NUMERIC(14,2), -- Nullable para meses sin dato
  created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at TIMESTAMPTZ
);

-- Evita duplicados por año+mes
CREATE UNIQUE INDEX IF NOT EXISTS ux_monthly_operations_year_month ON monthly_operations (year, month);
CREATE INDEX IF NOT EXISTS idx_monthly_operations_year ON monthly_operations (year);

-- Inserts reales para 2025 (valores provistos).
-- Nota: se usa NULL para columnas donde no hay dato disponible (ej. mes 12 operaciones generales/peso).
INSERT INTO monthly_operations (year, month, comercial_ops, comercial_pax, general_ops, general_pax, carga_ops, carga_tons, updated_at)
VALUES
(2025, 1, 4488, 565716, 251, 2353, 880, 27764.47, now()),
(2025, 2, 4016, 488440, 242, 1348, 803, 26628.78, now()),
(2025, 3, 4426, 570097, 272, 1601, 916, 33154.97, now()),
(2025, 4, 4575, 621197, 249, 1840, 902, 30785.67, now()),
(2025, 5, 4443, 586299, 226, 1576, 1006, 34190.60, now()),
(2025, 6, 4129, 541400, 209, 3177, 1014, 37708.07, now()),
(2025, 7, 4430, 604758, 234, 1515, 1021, 35649.92, now()),
(2025, 8, 4500, 630952, 282, 3033, 1082, 35737.78, now()),
(2025, 9, 4135, 546457, 249, 948, 992, 31076.71, now()),
(2025, 10, 4291, 584629, 315, 1298, 1155, 37273.41, now()),
(2025, 11, 4458, 632853, 285, 1089, 1127, 38433.81, now()),
(2025, 12, NULL, 704718, NULL, NULL, NULL, NULL, now())
ON CONFLICT (year, month) DO UPDATE
  SET comercial_ops = COALESCE(EXCLUDED.comercial_ops, monthly_operations.comercial_ops),
      comercial_pax = COALESCE(EXCLUDED.comercial_pax, monthly_operations.comercial_pax),
      general_ops = COALESCE(EXCLUDED.general_ops, monthly_operations.general_ops),
      general_pax = COALESCE(EXCLUDED.general_pax, monthly_operations.general_pax),
      carga_ops = COALESCE(EXCLUDED.carga_ops, monthly_operations.carga_ops),
      carga_tons = COALESCE(EXCLUDED.carga_tons, monthly_operations.carga_tons),
      updated_at = now();

-- Fin del fichero



-- ANNUAL OPERATIONS SCHEMA & DATA --
-- 002_annual_operations_real.sql
-- DDL y datos anuales reales para annual_operations
-- Ejecutar en Supabase -> Database -> SQL editor

CREATE TABLE IF NOT EXISTS annual_operations (
  id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  year INTEGER NOT NULL UNIQUE,
  comercial_ops_total BIGINT DEFAULT 0,
  comercial_pax_total BIGINT DEFAULT 0,
  general_ops_total BIGINT DEFAULT 0,
  general_pax_total BIGINT DEFAULT 0,
  carga_ops_total BIGINT DEFAULT 0,
  carga_tons_total NUMERIC(18,2) DEFAULT 0,
  created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at TIMESTAMPTZ
);

CREATE INDEX IF NOT EXISTS idx_annual_operations_year ON annual_operations (year);

-- Inserts/Upsert con los totales reales (2022-2025)
INSERT INTO annual_operations (year, comercial_ops_total, comercial_pax_total, general_ops_total, general_pax_total, carga_ops_total, carga_tons_total, updated_at)
VALUES
(2022, 8996, 912415, 458, 1385, 8, 5.19, now()),
(2023, 23211, 2631261, 2212, 8160, 5578, 186319.83, now()),
(2024, 51734, 6318454, 2777, 29637, 13219, 447341.17, now()),
(2025, 49160, 6547109, 2891, 20577, 11168, 377761.43, now())
ON CONFLICT (year) DO UPDATE
  SET comercial_ops_total = EXCLUDED.comercial_ops_total,
      comercial_pax_total = EXCLUDED.comercial_pax_total,
      general_ops_total = EXCLUDED.general_ops_total,
      general_pax_total = EXCLUDED.general_pax_total,
      carga_ops_total = EXCLUDED.carga_ops_total,
      carga_tons_total = EXCLUDED.carga_tons_total,
      updated_at = now();

-- Opcional: vista que calcula los totales desde monthly_operations (si prefieres no persistir)
CREATE OR REPLACE VIEW view_annual_operations_from_monthly AS
SELECT
  year,
  SUM(COALESCE(comercial_ops,0))::bigint AS comercial_ops_total,
  SUM(COALESCE(comercial_pax,0))::bigint AS comercial_pax_total,
  SUM(COALESCE(general_ops,0))::bigint AS general_ops_total,
  SUM(COALESCE(general_pax,0))::bigint AS general_pax_total,
  SUM(COALESCE(carga_ops,0))::bigint AS carga_ops_total,
  SUM(COALESCE(carga_tons,0))::numeric(18,2) AS carga_tons_total
FROM monthly_operations
GROUP BY year
ORDER BY year DESC;

-- Fin del fichero



-- PARTE OPERACIONES SCHEMA --

CREATE TABLE IF NOT EXISTS parte_operaciones (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    fecha DATE NOT NULL UNIQUE,
    comercial_arr INTEGER DEFAULT 0,
    comercial_dep INTEGER DEFAULT 0,
    carga_arr INTEGER DEFAULT 0,
    carga_dep INTEGER DEFAULT 0,
    general_arr INTEGER DEFAULT 0,
    general_dep INTEGER DEFAULT 0,
    total_general INTEGER GENERATED ALWAYS AS (comercial_arr + comercial_dep + carga_arr + carga_dep + general_arr + general_dep) STORED,
    pdf_path TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL
);
ALTER TABLE parte_operaciones ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Public read access" ON parte_operaciones FOR SELECT USING (true);
CREATE POLICY "Authenticated full access" ON parte_operaciones FOR ALL TO authenticated USING (true) WITH CHECK (true);



-- OPERATIONS SUMMARY DATA --
INSERT INTO operations_summary (year, month, category, metric, value) VALUES 
(2022, NULL, 'comercial', 'operaciones', 8996),
(2022, NULL, 'comercial', 'pasajeros', 912415),
(2023, NULL, 'comercial', 'operaciones', 23211),
(2023, NULL, 'comercial', 'pasajeros', 2631261),
(2024, NULL, 'comercial', 'operaciones', 51734),
(2024, NULL, 'comercial', 'pasajeros', 6318454),
(2025, NULL, 'comercial', 'operaciones', 49160),
(2025, NULL, 'comercial', 'pasajeros', 6547109),
(2022, NULL, 'carga', 'operaciones', 8),
(2022, NULL, 'carga', 'toneladas', 5.19),
(2023, NULL, 'carga', 'operaciones', 5578),
(2023, NULL, 'carga', 'toneladas', 186319.83),
(2024, NULL, 'carga', 'operaciones', 13219),
(2024, NULL, 'carga', 'toneladas', 447341.17),
(2025, NULL, 'carga', 'operaciones', 11168),
(2025, NULL, 'carga', 'toneladas', 377761.43),
(2022, NULL, 'general', 'operaciones', 458),
(2022, NULL, 'general', 'pasajeros', 1385),
(2023, NULL, 'general', 'operaciones', 2212),
(2023, NULL, 'general', 'pasajeros', 8160),
(2024, NULL, 'general', 'operaciones', 2777),
(2024, NULL, 'general', 'pasajeros', 29637),
(2025, NULL, 'general', 'operaciones', 2891),
(2025, NULL, 'general', 'pasajeros', 20577);

-- MEDICAL ATTENTIONS DATA --
INSERT INTO medical_attentions (year, month, aifa_count, other_company_count, passenger_count, visitor_count) VALUES 
(2022, 'ABRIL', 29, 117, 36, 36),
(2022, 'MAYO', 34, 106, 23, 12),
(2022, 'JUNIO', 68, 82, 16, 5),
(2022, 'JULIO', 41, 71, 20, 7),
(2022, 'AGOSTO', 39, 80, 10, 4),
(2022, 'SEPTIEMBRE', 15, 155, 85, 0),
(2022, 'OCTUBRE', 34, 112, 77, 9),
(2022, 'NOVIEMBRE', 47, 91, 63, 8),
(2022, 'DICIEMBRE', 66, 95, 94, 9),
(2023, 'ENERO', 49, 62, 70, 9),
(2023, 'FEBRERO', 20, 56, 36, 10),
(2023, 'MARZO', 7, 17, 20, 2),
(2023, 'ABRIL', 21, 64, 54, 4),
(2023, 'MAYO', 27, 79, 72, 7),
(2023, 'JUNIO', 52, 47, 59, 2),
(2023, 'JULIO', 65, 58, 66, 2),
(2023, 'AGOSTO', 58, 69, 78, 21),
(2023, 'SEPTIEMBRE', 80, 66, 63, 17),
(2023, 'OCTUBRE', 90, 64, 106, 22),
(2023, 'NOVIEMBRE', 74, 72, 111, 10),
(2023, 'DICIEMBRE', 127, 68, 106, 15),
(2024, 'ENERO', 143, 108, 156, 18),
(2024, 'FEBRERO', 69, 111, 141, 19),
(2024, 'MARZO', 95, 128, 192, 16),
(2024, 'ABRIL', 93, 141, 261, 20),
(2024, 'MAYO', 42, 136, 296, 19),
(2024, 'JUNIO', 75, 121, 243, 37),
(2024, 'JULIO', 90, 96, 300, 22),
(2024, 'AGOSTO', 62, 102, 231, 12),
(2024, 'SEPTIEMBRE', 72, 109, 221, 12),
(2024, 'OCTUBRE', 46, 100, 209, 14),
(2024, 'NOVIEMBRE', 51, 122, 219, 18),
(2024, 'DICIEMBRE', 68, 128, 225, 15),
(2025, 'ENERO', 65, 102, 188, 14),
(2025, 'FEBRERO', 103, 64, 199, 20),
(2025, 'MARZO', 111, 110, 256, 18),
(2025, 'ABRIL', 66, 94, 238, 22),
(2025, 'MAYO', 84, 105, 238, 16),
(2025, 'JUNIO', 87, 107, 211, 20),
(2025, 'JULIO', 90, 138, 257, 26),
(2025, 'AGOSTO', 96, 109, 236, 20),
(2025, 'SEPTIEMBRE', 75, 118, 190, 22),
(2025, 'OCTUBRE', 104, 129, 186, 26),
(2025, 'NOVIEMBRE', None, None, None, None),
(2025, 'DICIEMBRE', None, None, None, None);

-- WILDLIFE INCIDENTS DATA --
INSERT INTO wildlife_incidents (date, time, location, impact_zone, phase, airline, aircraft, registration, remains_location, remains_amount, size, species, common_name, reporter, proactive_measures, weather_conditions, results, observations) VALUES 
('2025-05-02', '18:38', '04C-22C', 'K11-K14', 'Aterrizaje', 'Mexicana', 'B737/8', 'XA-ATM', 'Parabrisas y fuselaje', '1', 'Pequeño', 'Zenaida macroura', 'Huilota común', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Llovizna', 'Dispersión de fauna.', ''),
('2025-06-13', '10:47', '04L-22R', 'A5', 'Aterrizaje', 'Omni Air', 'Boeing 767', 'N207AX', 'Radomo y Motor No. 2', '4', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-06-14', '11:30', '04C-22C', 'K7', 'Aterrizaje', 'Aeromexico', 'E-190', 'XA-GAE', 'Tren de aterrizaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-06-16', '17:00', '04C-22C', 'K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', '9H-MLS', 'Parabrisas/Radomo', '5', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-06-16', '17:34', '04C-22C', 'K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', '9H-MLQ', 'Ala derecha en flaps', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-06-30', '13:20', '04C-22C', 'K7', 'Despegue', 'Viva Aerobus', 'A-320', 'XA-VOM', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-06-30', '13:50', '04C-22C', 'K6', 'Despegue', 'Viva Aerobus', 'A-320', 'XA-VAA', 'Desconocido', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-06-30', '16:51', '04C-22C', 'K11-K14', 'Aterrizaje', 'Viva Aerobus', 'A-320', '7427', 'Parabrisas', '1', 'Pequeño', 'Charadrius vociferus', 'Chorlo tildío', 'Olimpo', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-07-03', '13:11', '04L-22R', 'A3-A5', 'Aterrizaje', 'Mas Air', 'A-332', 'EIMYY', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-05', '08:47', '04C-22C', 'K6-K7', 'Despegue', 'Viva Aerobus', 'A-320', '9H-MLP', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-07-11', '08:25', '04L-22R', 'A6', 'Despegue', 'Viva Aerobus', 'A-320', 'XAVAU', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-07-12', '07:48', '04C-22C', 'K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', '9M-SWA', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-07-12', '10:17', '04L-22R', 'A6', 'Aterrizaje', 'Atlas air', 'A-320', 'N70BGT', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-07-15', '10:00', '04L-22R', 'A3', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XA-VDE', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-19', '08:07', '04C-22C', 'K7', 'Aterrizaje', 'Aeromexico', 'A-320', 'XA-ACT', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-20', '08:03', '04L-22R', 'A5-A6', 'Despegue', 'Aerounion', 'A-330', '6R7083', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-22', '08:12', '04L-22R', 'A10', 'Despegue', 'Viva Aerobus', 'A-320', '7240', 'Tren de aterrizaje', '1', 'Mediano', 'Lepus californicus', 'Liebre cola negra', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-28', '07:30', '04L-22R', 'A5', 'Aterrizaje', 'Air Canada', '767', '7248', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-07-29', '08:33', '04C-22C', 'K6-K7', 'Despegue', 'Aeromexico', 'A-320', '2436', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-05', '08:40', '04C-22C', 'K6-K7', 'Despegue', 'Viva Aerobus', 'A-320', '7350', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-08', '09:26', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XA-VCC', 'Radomo, borde de ataque y flaps', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-11', '08:30', '04C-22C', 'K3-K6', 'Despegue', 'Viva Aerobus', 'A-320', '7302', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-13', '08:40', '04L-22R', 'A5', 'Aterrizaje', 'Cargojet', 'B-767', '952', 'Fuselaje', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-16', '08:55', '04C-22C', 'K6-K7', 'Despegue', 'Viva Aerobus', 'A-320', '7350', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-16', '13:07', '04C-22C', 'K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XAVA4', 'Motor 2 y ala derecha', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-16', '13:43', '04C-22C', 'K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', '7332', 'Radomo', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado- Neblina', 'Dispersión de fauna.', ''),
('2025-08-17', '08:42', '04C-22C', 'K6-K7', 'Aterrizaje', 'Cargojet', 'B-767', 'VB845', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-17', '09:12', '04L-22R', 'A3-A5', 'Aterrizaje', 'Cargojet', 'B-767', 'CG-AJG', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-19', '08:23', '04L-22R', 'A3-A5', 'Aterrizaje', 'Cargojet', 'B-767', 'C-GAJG', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-20', '08:45', '04L-22R', 'A3-A5', 'Despegue', 'Volaris', 'A-320', '3536', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-21', '07:13', '04C-22C', 'K6-K7', 'Aterrizaje', 'Viva Aerobus', 'A-320', '7240', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-21', '08:23', '04L-22R', 'A6', 'Despegue', 'Aeromexico', 'A-320', '592', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-21', '10:07', '04C-22C', 'K7-K11', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XA-VAC', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-21', '10:08', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '9215', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-21', '11:03', '04C-22C', 'K3-K6', 'Despegue', 'Viva Aerobus', 'A-320', '9402', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-22', '08:05', '04C-22C', 'K6', 'Aterrizaje', 'Volaris', 'A-320', '1290', 'Flap semiala derecha', '1', 'Pequeño', 'Calidris bairdi', 'Playero de Baird', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-22', '08:19', '04L-22R', 'A5', 'Aterrizaje', 'Cargojet', 'B-767', '7673', 'Semiala derecha', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-23', '08:27', '04C-22C', 'K3-K6', 'Despegue', 'Aeromexico', 'A-321', '592', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-23', '09:16', '04C-22C', 'K3-K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '521', 'Parabrisas', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-23', '10:20', '04L-22R', 'A3-A5', 'Aterrizaje', 'Atlas air', 'A-320', '339', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-24', '07:35', '04C-22C', 'K6', 'Aterrizaje', 'Aeromexico', 'A-321', '2469', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-25', '07:37', '04C-22C', 'K6', 'Aterrizaje', 'Volaris', 'A-320', '1290', 'Semiala derecha', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-26', '07:58', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '7332', 'Radomo y tren de aterrizaje', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-27', '10:05', '04L-22R', 'K5-K6', 'Aterrizaje', 'Mas Air', 'A-332', '3228', 'Semiala izquierda', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-27', '10:10', '04C-22C', 'A6', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XA-VBM', 'Fuselaje', '4', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-27', '10:59', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '5069', 'Motor derecho', '7', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-08-31', '08:46', '04L-22R', 'A11', 'Aterrizaje', 'Cargojet', 'B-767', 'CF-DIJ', 'Fuselaje y tren de aterrizaje', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-08-31', '11:13', '04C-22C', 'K11', 'Aterrizaje', 'Cargojet', '', '7111', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-02', '09:13', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'VB9521', 'Radomo y moto izquierdo', '6', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-05', '07:55', '04C-22C', 'K6', 'Aterrizaje', 'Volaris', 'A-320', 'N515VL', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-08', '08:25', '04L-22R', 'A5-A6', 'Despegue', 'Aeromexico', 'E-190', 'XA-GAG', 'Desconocido', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-09-08', '08:43', '04L-22R', 'A6', 'Despegue', 'Viva Aerobus', 'A-320', 'XA-VDJ', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna.', ''),
('2025-09-09', '09:10', '04L-22R', 'A5-A6', 'Aterrizaje', 'Air China', 'B-777', '3125', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-10', '07:55', '04L-22R', 'A3-A6', 'Aterrizaje', 'Cargojet', 'B-752', 'B763/C-GCJ', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-11', '09:33', '04C-22C', 'A6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '9521/XA-VYE', 'Parabrisas', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-11', '08:54', '04L-22R', 'K3-K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', '7250', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-12', '11:11', '04L-22R', 'A5-A8', 'Aterrizaje', 'Kalitta air', 'B-744', 'N709CK', 'Motor derecho/Flap semiala derecha', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-16', '08:29', '04C-22C', 'K6', 'Despegue', 'Aeromexico', 'E-190', 'XA-ACJ', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico.Despejado', 'Despejado', 'Dispersión de fauna.', ''),
('2025-09-17', '10:14', '04C-22C', 'K6', 'Aterrizaje', 'Mas Air', 'A-332', 'MAA3228', 'Motor derecho y fuselaje', '5', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico.Despejado Implementación de pirotecnica, repelente electronicoDespejado', 'Despejado', 'Dispersión de fauna', ''),
('2025-09-21', '09:02', '04L-22R', 'A3-A6', 'Aterrizaje', 'Mas Air', 'A-330', 'MAA6811', 'Radomo', '4', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna', ''),
('2025-09-23', '11:25', '04C-22C', 'K6', 'Aterrizaje', 'Aeromexico', 'A-330', '2781', 'Radomo', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna', ''),
('2025-09-26', '09:38', '04C-22C', 'K6', 'Aterrizaje', 'Mas Air', 'A-330', 'ΕΙ-ΜΜΑ', 'Fuselaje', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna', ''),
('2025-09-29', '08:05', '04L-22R', 'A3', 'Aterrizaje', 'Volaris', 'A-320', 'N507VL', 'Radomo', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna', ''),
('2025-10-02', '16:00', '04L-22R', 'A10', 'Aterrizaje', 'Mas Air', 'A-330', 'EI-MAF', 'Tren de aterrizaje', '1', 'Pequeño', 'Falco sparverius', 'Cernicalo americano', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna', ''),
('2025-10-04', '10:26', '04C-22C', 'K11', 'Despegue', 'Viva Aerobus', 'A-320', 'VB5069', 'Desconocido', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna', ''),
('2025-10-05', '10:14', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'XAVAK', 'Parabrisas', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna', ''),
('2025-10-06', '09:05', '04C-22C', 'K6', 'Aterrizaje', 'Viva Aerobus', 'A-320', 'VIV9521', 'Parabrisas y motor derecho', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Nublado', 'Dispersión de fauna', ''),
('2025-10-21', '10:21', '04L-22R', 'K6-K11', 'Despegue', 'Mexicana', 'E-195', 'ΧΑΜΧΑ', 'Desconocido', '8', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna', ''),
('2025-11-02', '09:47', '04C-22C', 'K6-K11', 'Aterrizaje', 'Viva Aerobus', 'A-321', 'VB9401', 'Radomo', '2', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off).', 'Despejado', 'Dispersión de fauna', ''),
('2025-11-05', '10:44', '04C-22C', 'K6', 'Aterrizaje', 'Volaris', 'A-320', 'XA-VLE', 'Radomo', '3', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia y repelente electrónico', 'Despejado', 'Dispersión de fauna', ''),
('2025-11-07', '09:43', '04C-22C', 'K3-K7', 'Aterrizaje', 'Viva Aerobus', 'A-321', 'XA-VXL', 'Radomo y Motor No. 2', '6', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia y repelente electrónico', 'Despejado', 'Dispersión de fauna', ''),
('2025-11-09', '08:45', '04C-22C', 'K7', 'Aterrizaje', 'Arajet', 'A-320', 'HI1104', 'Parabrisas', '1', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia y repelente electrónico', 'Despejado', 'Dispersión de fauna', ''),
('2025-11-19', '7:57', '04L-22R', 'A6', 'Despegue', 'Mexicana', '195-E2', 'XA-MXB', 'Radomo, motor y tren de aterrizaje', '10', 'Pequeño', 'Hirundo rustica', 'Golondrina tijereta', 'TWR', 'Implementación de pirotecnia, repelente electrónico y aplicación de químicos (DDVP, Resifum, Bird-off)', 'Despejado', 'Dispersión de fauna', '');

-- DELAYS DATA --
INSERT INTO delays (year, month, cause, count, description, observations) VALUES 
(2025, 'NOVIEMBRE', 'Repercusión', 507, 'Se origina en otros aeropuertos y su consecuente llegada tardía al AIFA.', ''),
(2025, 'NOVIEMBRE', 'Compañía', 190, 'Las principales causas son mantenimiento no programado, espera de tripulación, conveniencia de la aerolínea y flujo lento de pasajeros.', ''),
(2025, 'NOVIEMBRE', 'Evento Circunstancial', 3, 'Se origina por pasajeros disruptivos, pasajeros o tripulantes enfermos, pasajeros con poca movilidad, así como, espera por tráfico aéreo.', ''),
(2025, 'NOVIEMBRE', 'Combustible', 1, 'Demoras causadas por disponibilidad o gestión de combustible.', 'Demora de 23 minutos por falta de personal.'),
(2025, 'NOVIEMBRE', 'Autoridad', 0, 'Demoras relacionadas con inspecciones o procesos a cargo de la autoridad.', ''),
(2025, 'NOVIEMBRE', 'Meteorología', 12, 'Sucede por esperar mejores condiciones meteorológicas en el aeropuerto de destino, principalmente lluvia y bancos de niebla.', ''),
(2025, 'NOVIEMBRE', 'Aeropuerto', 1, 'Demoras derivadas de infraestructura o servicios del propio aeropuerto.', 'Demora de 20 minutos por falla del dispositivo electrónico; que abre y cierra la esclusa electrónicamente (relevador), en la posición 106A.');

-- PUNCTUALITY DATA --
INSERT INTO punctuality (year, month, category, airline, on_time, delayed, cancelled, percentage) VALUES 
(2025, 'NOVIEMBRE', 'Pasajeros', 'Magnicharters', 1, 0, 0, '100'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Mexicana', 184, 15, 2, '92'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Aerus', 48, 9, 0, '84'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Aeroméxico', 294, 21, 42, '82'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Arajet', 32, 6, 1, '82'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Volaris', 161, 37, 2, '81'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Viva', 1102, 310, 12, '77'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Conviasa', 1, 3, 0, '25'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Iberojet', 0, 1, 0, '0'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'World2fly', 0, 1, 0, '0'),
(2025, 'NOVIEMBRE', 'Pasajeros', 'Total', 1823, 403, 59, '80'),
(2025, 'NOVIEMBRE', 'Carga', 'Ethiopian Airlines', 8, 1, 0, '89'),
(2025, 'NOVIEMBRE', 'Carga', 'UPS', 19, 2, 1, '86'),
(2025, 'NOVIEMBRE', 'Carga', 'Air France', 6, 2, 0, '75'),
(2025, 'NOVIEMBRE', 'Carga', 'Cargojet', 28, 6, 10, '64'),
(2025, 'NOVIEMBRE', 'Carga', 'Lufthansa', 17, 12, 0, '59'),
(2025, 'NOVIEMBRE', 'Carga', 'Awesome Cargo', 9, 9, 0, '50'),
(2025, 'NOVIEMBRE', 'Carga', 'DHL Guatemala', 9, 4, 5, '50'),
(2025, 'NOVIEMBRE', 'Carga', 'Turkish', 2, 2, 0, '50'),
(2025, 'NOVIEMBRE', 'Carga', 'Silk Waywest Airlines', 2, 2, 0, '50'),
(2025, 'NOVIEMBRE', 'Carga', 'Cathay Pacific', 11, 15, 0, '42'),
(2025, 'NOVIEMBRE', 'Carga', 'Air Canada', 11, 14, 2, '41'),
(2025, 'NOVIEMBRE', 'Carga', 'Atlas Air', 24, 28, 10, '39'),
(2025, 'NOVIEMBRE', 'Carga', 'Mas de Carga', 29, 39, 10, '37'),
(2025, 'NOVIEMBRE', 'Carga', 'Aerounión', 16, 16, 13, '36'),
(2025, 'NOVIEMBRE', 'Carga', 'Emirates Airlines', 6, 10, 1, '35'),
(2025, 'NOVIEMBRE', 'Carga', 'Cargolux', 11, 20, 3, '32'),
(2025, 'NOVIEMBRE', 'Carga', 'Estafeta', 19, 34, 10, '30'),
(2025, 'NOVIEMBRE', 'Carga', 'Kalitta Air', 8, 15, 7, '27'),
(2025, 'NOVIEMBRE', 'Carga', 'QATAR', 1, 1, 2, '25'),
(2025, 'NOVIEMBRE', 'Carga', 'FEDEX', 1, 3, 0, '25'),
(2025, 'NOVIEMBRE', 'Carga', 'La Nueva Aerolinea', 2, 6, 1, '22'),
(2025, 'NOVIEMBRE', 'Carga', 'Amerijet', 1, 4, 0, '20'),
(2025, 'NOVIEMBRE', 'Carga', 'TSM', 3, 14, 0, '18'),
(2025, 'NOVIEMBRE', 'Carga', 'Air China', 3, 11, 5, '16'),
(2025, 'NOVIEMBRE', 'Carga', 'China Southern', 4, 24, 4, '13'),
(2025, 'NOVIEMBRE', 'Carga', 'National Airlines Cargo', 1, 14, 0, '7'),
(2025, 'NOVIEMBRE', 'Carga', 'Suparna Airlines', 0, 4, 1, '0'),
(2025, 'NOVIEMBRE', 'Carga', 'Total', 251, 312, 85, '39');

-- DAILY OPERATIONS DATA --
INSERT INTO daily_operations (fecha, comercial_llegada, comercial_salida, carga_llegada, carga_salida, general_llegada, general_salida, total_general) VALUES 
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0),
('None', 0, 0, 0, 0, 0, 0, 0) ON CONFLICT (fecha) DO NOTHING;
